{"timestamp":"2025-11-30T13:55:04.452623Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-11-30T13:55:04.457475Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/ingest_weather.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-11-30T13:55:08.147932Z","level":"info","event":"Pandas backend loaded 2.1.4","logger":"visions.backends","filename":"__init__.py","lineno":14}
{"timestamp":"2025-11-30T13:55:08.162311Z","level":"info","event":"Numpy backend loaded 1.26.4","logger":"visions.backends","filename":"__init__.py","lineno":25}
{"timestamp":"2025-11-30T13:55:08.167252Z","level":"info","event":"Pyspark backend NOT loaded","logger":"visions.backends","filename":"__init__.py","lineno":37}
{"timestamp":"2025-11-30T13:55:08.168593Z","level":"info","event":"Python backend loaded","logger":"visions.backends","filename":"__init__.py","lineno":43}
{"timestamp":"2025-11-30T13:55:17.691503Z","level":"warning","event":"The `airflow.decorators.dag` attribute is deprecated. Please use `'airflow.sdk.dag'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/ingest_weather.py","lineno":2,"logger":"py.warnings"}
{"timestamp":"2025-11-30T13:55:17.692177Z","level":"warning","event":"The `airflow.decorators.task` attribute is deprecated. Please use `'airflow.sdk.task'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/ingest_weather.py","lineno":2,"logger":"py.warnings"}
{"timestamp":"2025-11-30T13:55:17.793227Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2025-11-30T13:55:17.794128Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2025-11-30T13:55:17.794987Z","level":"info","event":"Current task name:profile_and_log","logger":"task.stdout"}
{"timestamp":"2025-11-30T13:55:17.795746Z","level":"info","event":"Dag name:ingest_weather","logger":"task.stdout"}
{"timestamp":"2025-11-30T13:55:19.194280Z","level":"error","event":"\rSummarize dataset:   0%|          | 0/5 [00:00<?, ?it/s]\rSummarize dataset:   0%|          | 0/17 [00:00<?, ?it/s, Describe variable: dt]\rSummarize dataset:   0%|          | 0/17 [00:00<?, ?it/s, Describe variable: temp]\rSummarize dataset:   0%|          | 0/17 [00:00<?, ?it/s, Describe variable: humidity]\rSummarize dataset:   0%|          | 0/17 [00:00<?, ?it/s, Describe variable: pressure]\rSummarize dataset:   0%|          | 0/17 [00:00<?, ?it/s, Describe variable: wind_speed]\rSummarize dataset:   0%|          | 0/17 [00:00<?, ?it/s, Describe variable: clouds]    \rSummarize dataset:   0%|          | 0/17 [00:00<?, ?it/s, Describe variable: lag3]  \rSummarize dataset:   0%|          | 0/17 [00:00<?, ?it/s, Describe variable: lag3]","logger":"task.stderr"}
{"timestamp":"2025-11-30T13:55:19.335770Z","level":"error","event":"\r  0%|          | 0/12 [00:00<?, ?it/s]\u001b[A\rSummarize dataset:   6%|▌         | 1/17 [00:00<00:03,  4.90it/s, Describe variable: lag3]\rSummarize dataset:   6%|▌         | 1/17 [00:00<00:03,  4.90it/s, Describe variable: roll3]\rSummarize dataset:  18%|█▊        | 3/17 [00:00<00:02,  4.90it/s, Describe variable: day_of_week]\rSummarize dataset:  24%|██▎       | 4/17 [00:00<00:02,  4.90it/s, Describe variable: target_temp_4h]\rSummarize dataset:  24%|██▎       | 4/17 [00:00<00:02,  4.90it/s, Describe variable: target_temp_4h]","logger":"task.stderr"}
{"timestamp":"2025-11-30T13:55:19.384679Z","level":"error","event":"\r 50%|█████     | 6/12 [00:00<00:00, 44.62it/s]\u001b[A\rSummarize dataset:  47%|████▋     | 8/17 [00:00<00:00, 26.66it/s, Describe variable: target_temp_4h]\r100%|██████████| 12/12 [00:00<00:00, 65.02it/s]","logger":"task.stderr"}
{"timestamp":"2025-11-30T13:55:19.413602Z","level":"error","event":"\rSummarize dataset:  71%|███████   | 12/17 [00:00<00:00, 26.66it/s, Get variable types]              \rSummarize dataset:  72%|███████▏  | 13/18 [00:00<00:00, 26.66it/s, Get dataframe statistics]\rSummarize dataset:  78%|███████▊  | 14/18 [00:00<00:00, 26.66it/s, Get scatter matrix]      \rSummarize dataset:  78%|███████▊  | 14/18 [00:00<00:00, 26.66it/s, Take sample]       \rSummarize dataset:  83%|████████▎ | 15/18 [00:00<00:00, 26.66it/s, Detecting duplicates]\rSummarize dataset:  89%|████████▉ | 16/18 [00:00<00:00, 26.66it/s, Get alerts]          \rSummarize dataset:  94%|█████████▍| 17/18 [00:00<00:00, 26.66it/s, Get reproduction details]\rSummarize dataset: 100%|██████████| 18/18 [00:00<00:00, 26.66it/s, Completed]               \rSummarize dataset: 100%|██████████| 18/18 [00:00<00:00, 45.28it/s, Completed]","logger":"task.stderr"}
{"timestamp":"2025-11-30T13:55:53.231652Z","level":"error","event":"\rGenerate report structure:   0%|          | 0/1 [00:00<?, ?it/s]\rGenerate report structure: 100%|██████████| 1/1 [00:33<00:00, 33.82s/it]\rGenerate report structure: 100%|██████████| 1/1 [00:33<00:00, 33.82s/it]","logger":"task.stderr"}
{"timestamp":"2025-11-30T13:55:54.201815Z","level":"error","event":"\rRender HTML:   0%|          | 0/1 [00:00<?, ?it/s]\rRender HTML: 100%|██████████| 1/1 [00:00<00:00,  1.03it/s]\rRender HTML: 100%|██████████| 1/1 [00:00<00:00,  1.03it/s]","logger":"task.stderr"}
{"timestamp":"2025-11-30T13:55:54.277330Z","level":"error","event":"\rExport report to file:   0%|          | 0/1 [00:00<?, ?it/s]\rExport report to file: 100%|██████████| 1/1 [00:00<00:00, 13.46it/s]","logger":"task.stderr"}
{"timestamp":"2025-11-30T13:55:54.533009Z","level":"warning","event":"Retrying (Retry(total=6, connect=6, read=7, redirect=7, status=7)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff8263080>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion","logger":"urllib3.connectionpool","filename":"connectionpool.py","lineno":868}
{"timestamp":"2025-11-30T13:55:59.417519Z","level":"warning","event":"Retrying (Retry(total=5, connect=5, read=7, redirect=7, status=7)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff82f0350>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion","logger":"urllib3.connectionpool","filename":"connectionpool.py","lineno":868}
{"timestamp":"2025-11-30T13:56:08.355833Z","level":"warning","event":"Retrying (Retry(total=4, connect=4, read=7, redirect=7, status=7)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff84ce480>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion","logger":"urllib3.connectionpool","filename":"connectionpool.py","lineno":868}
{"timestamp":"2025-11-30T13:56:24.412822Z","level":"warning","event":"Retrying (Retry(total=3, connect=3, read=7, redirect=7, status=7)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff84cd070>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion","logger":"urllib3.connectionpool","filename":"connectionpool.py","lineno":868}
{"timestamp":"2025-11-30T13:56:56.464141Z","level":"warning","event":"Retrying (Retry(total=2, connect=2, read=7, redirect=7, status=7)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff84cf9b0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion","logger":"urllib3.connectionpool","filename":"connectionpool.py","lineno":868}
{"timestamp":"2025-11-30T13:58:01.165871Z","level":"warning","event":"Retrying (Retry(total=1, connect=1, read=7, redirect=7, status=7)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff8152de0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion","logger":"urllib3.connectionpool","filename":"connectionpool.py","lineno":868}
{"timestamp":"2025-11-30T14:00:01.180546Z","level":"warning","event":"Retrying (Retry(total=0, connect=0, read=7, redirect=7, status=7)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff8289160>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion","logger":"urllib3.connectionpool","filename":"connectionpool.py","lineno":868}
{"timestamp":"2025-11-30T14:00:01.219265Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"MlflowException","exc_value":"API request to http://mlflow:5000/api/2.0/mlflow/experiments/get-by-name failed with exception HTTPConnectionPool(host='mlflow', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff82889e0>: Failed to establish a new connection: [Errno 111] Connection refused'))","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":252,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/ingest_weather.py","lineno":121,"name":"profile_and_log"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/mlflow/tracking/fluent.py","lineno":187,"name":"set_experiment"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/mlflow/tracking/_tracking_service/client.py","lineno":280,"name":"get_experiment_by_name"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/mlflow/store/tracking/rest_store.py","lineno":865,"name":"get_experiment_by_name"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/mlflow/store/tracking/rest_store.py","lineno":203,"name":"_call_endpoint"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/mlflow/utils/rest_utils.py","lineno":591,"name":"call_endpoint"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/mlflow/utils/rest_utils.py","lineno":259,"name":"http_request"}],"is_group":false,"exceptions":[]},{"exc_type":"ConnectionError","exc_value":"HTTPConnectionPool(host='mlflow', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff82889e0>: Failed to establish a new connection: [Errno 111] Connection refused'))","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/mlflow/utils/rest_utils.py","lineno":236,"name":"http_request"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/mlflow/utils/request_utils.py","lineno":237,"name":"_get_http_response_with_retries"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/sessions.py","lineno":589,"name":"request"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/sessions.py","lineno":703,"name":"send"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/adapters.py","lineno":677,"name":"send"}],"is_group":false,"exceptions":[]},{"exc_type":"MaxRetryError","exc_value":"HTTPConnectionPool(host='mlflow', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff82889e0>: Failed to establish a new connection: [Errno 111] Connection refused'))","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/adapters.py","lineno":644,"name":"send"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":871,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":871,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":871,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":871,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":871,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":871,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":871,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":841,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/retry.py","lineno":519,"name":"increment"}],"is_group":false,"exceptions":[]},{"exc_type":"NewConnectionError","exc_value":"<urllib3.connection.HTTPConnection object at 0x70dff82889e0>: Failed to establish a new connection: [Errno 111] Connection refused","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":787,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":493,"name":"_make_request"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py","lineno":494,"name":"request"},{"filename":"/usr/python/lib/python3.12/http/client.py","lineno":1333,"name":"endheaders"},{"filename":"/usr/python/lib/python3.12/http/client.py","lineno":1093,"name":"_send_output"},{"filename":"/usr/python/lib/python3.12/http/client.py","lineno":1037,"name":"send"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py","lineno":325,"name":"connect"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py","lineno":213,"name":"_new_conn"}],"is_group":false,"exceptions":[]},{"exc_type":"ConnectionRefusedError","exc_value":"[Errno 111] Connection refused","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py","lineno":198,"name":"_new_conn"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/connection.py","lineno":85,"name":"create_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/connection.py","lineno":73,"name":"create_connection"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-11-30T14:00:01.404095Z","level":"info","event":"Task instance in failure state","logger":"task.stdout"}
{"timestamp":"2025-11-30T14:00:01.405586Z","level":"info","event":"Task start","logger":"task.stdout"}
{"timestamp":"2025-11-30T14:00:01.406762Z","level":"info","event":"Task:<Task(_PythonDecoratedOperator): profile_and_log>","logger":"task.stdout"}
{"timestamp":"2025-11-30T14:00:01.414178Z","level":"info","event":"Failure caused by API request to http://mlflow:5000/api/2.0/mlflow/experiments/get-by-name failed with exception HTTPConnectionPool(host='mlflow', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=weather_ingestion (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x70dff82889e0>: Failed to establish a new connection: [Errno 111] Connection refused'))","logger":"task.stdout"}
